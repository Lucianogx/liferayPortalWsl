"use strict";
/**
 * SPDX-FileCopyrightText: Â© 2020 Liferay, Inc. <https://liferay.com>
 * SPDX-License-Identifier: LGPL-3.0-or-later
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getFeaturesFilePath = void 0;
const dot_prop_1 = __importDefault(require("dot-prop"));
const fs_1 = __importDefault(require("fs"));
const FilePath_1 = __importDefault(require("../../file/FilePath"));
/**
 *
 * @param project
 * @param featuresKey
 * @param defaultPrjRelPosixPath a posix path relative to project root
 * @return absolute path to features file
 */
function getFeaturesFilePath(project, featuresKeyPath, defaultPrjRelPosixPath) {
    const { configuration, dir: projectDir } = project;
    const prjRelPosixPath = dot_prop_1.default.get(configuration, featuresKeyPath);
    if (prjRelPosixPath !== undefined) {
        return projectDir.join(new FilePath_1.default(prjRelPosixPath, { posix: true }))
            .asNative;
    }
    const defaultAbsPath = projectDir.join(new FilePath_1.default(defaultPrjRelPosixPath, { posix: true })).asNative;
    if (fs_1.default.existsSync(defaultAbsPath)) {
        return defaultAbsPath;
    }
    return undefined;
}
exports.getFeaturesFilePath = getFeaturesFilePath;
